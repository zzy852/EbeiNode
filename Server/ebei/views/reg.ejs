<!DOCTYPE html>
<html>
     <% include head %>
     <body>
          <div class="homeform">
          <div id="container" class="container">
              <div class="row">
               <div class="col-xs-12 col-sm-7 col-md-5">
               <% if (locals.success) { %>
               <div id="alt_sucess" class="alert alert-success">
                    <%- success %>
               </div>
               <% } %>
               <% if (locals.error) { %>
               <div id="alt_warning" class="alert alert-warning">
                    <%= error %>
               </div>
               <% } %>
               <form class="form-horizontal" method="post">
                    <fieldset>
                         <legend>加入分图
                             <a href="/login" class="text-white text-right pull-right font-normal">去登录</a>
                         </legend>
                         <div class="form-group">
                              <div class="col-xs-12">
                                   <input id="txtUserName" name="txtUserName" type="email" class="form-control floating-label" placeholder="账号(Email)" required autofocus />
                              </div>
                         </div>
                         <div class="form-group">
                              <div class="col-xs-12">
                                   <input id="txtUserPwd" name="txtUserPwd" type="password" class="form-control floating-label" placeholder="密码" required/>
                              </div>
                         </div>
                         <div class="form-group">
                              <div class="col-xs-12">
                                   <input id="txtUserRePwd"  name="txtUserRePwd" type="password" class="form-control floating-label" placeholder="重复密码" required/>
                              </div>
                         </div>
                         <div class="form-group">
                              <div class="col-lg-12">
                                   <button id="btnSub" class="btn btn-info btn-block" type="submit">加入分图</button>

                              </div>
                         </div>
                    </fieldset>
               </form>
                </div>
                    <div class="col-xs-12 col-sm-5 col-md-7">
                         <fieldset>
                         <legend>其他方式登录</legend>
                         <div class="btn btn-flat btn-fab btn-raised text-info fa fa-qq">
                         </div>
                         <div class="btn btn-flat btn-fab btn-raised text-info fa fa-weibo">
                         </div>
                         </fieldset>
                    </div>
              </div>
          </div>
          </div>
          <% include foot %>
          <script type="text/javascript">
          String.prototype.format = function(args) {
               var result = this;
               if (arguments.length > 0) {
                    if (arguments.length == 1 && typeof(args) == "object") {
                         for (var key in args) {
                              if (args[key] != undefined) {
                                   var reg = new RegExp("({" + key + "})", "g");
                                   result = result.replace(reg, args[key]);
                              }
                         }
                    } else {
                         for (var i = 0; i < arguments.length; i++) {
                              if (arguments[i] != undefined) {
                                   var reg = new RegExp("({)" + i + "(})", "g");
                                   result = result.replace(reg, arguments[i]);
                              }
                         }
                    }
               }
               return result;
          }
          $(function() {
               $('#btnSub').on('click', function() {
                    var $txtUserName = $('#txtUserName'),
                         txtUserNameVal = $.trim($txtUserName.val()),
                         $txtUserPwd = $('#txtUserPwd'),
                         txtUserPwdVal = $.trim($txtUserPwd.val()),
                         $txtUserRePwd = $('#txtUserRePwd'),
                         txtUserRePwdVal = $.trim($txtUserRePwd.val());
                    $txtUserName.popover({
                         content: function(){
                              if ($.trim($(this).val()).length == 0) {
                                   return '账号不能为空';
                              } else if(is.email($.trim($(this).val()))==false){
                                   return '请填写正确的邮箱(如:server@ebei.net)';
                              }
                         },
                         container: 'body',
                         placement: 'right',
                         delay: {
                              "show": 500,
                              "hide": 100
                         },
                         trigger: 'manual'
                    });
                    $txtUserPwd.popover({
                         content: '密码不能为空',
                         container: 'body',
                         placement: 'right',
                         delay: {
                              "show": 500,
                              "hide": 100
                         },
                         trigger: 'manual'
                    });
                    $txtUserRePwd.popover({
                         content: function(){
                              if ($.trim($(this).val()).length == 0) {
                                   return '重复密码不能为空';
                              }
                              else{
                                   return '两次密码不一致';
                              }
                         },
                         container: 'body',
                         placement: 'right',
                         delay: {
                              "show": 500,
                              "hide": 100
                         },
                         trigger: 'manual'
                    });
                    if (txtUserNameVal.length == 0) {
                         $txtUserPwd.popover('hide');
                         $txtUserRePwd.popover('hide');
                         $txtUserName.popover('show');
                         $txtUserName.focus();
                         return false;
                    }else if(is.email(txtUserNameVal)==false){
                         $txtUserPwd.popover('hide');
                         $txtUserRePwd.popover('hide');
                         $txtUserName.popover('show');
                         $txtUserName.focus();
                         return false;
                    } else if (txtUserPwdVal.length == 0) {
                         $txtUserRePwd.popover('hide');
                         $txtUserName.popover('hide');
                         $txtUserPwd.popover('show');
                         $txtUserPwd.focus();
                         return false;
                    } else if (txtUserRePwdVal.length == 0) {
                         $txtUserPwd.popover('hide');
                         $txtUserName.popover('hide');
                         $txtUserRePwd.popover('show');
                         $txtUserRePwd.focus();
                         return false;
                    } else if (txtUserPwdVal != txtUserRePwdVal) {
                         $txtUserPwd.popover('hide');
                         $txtUserName.popover('hide');
                         $txtUserRePwd.popover('show');
                         $txtUserRePwd.focus();
                         return false;
                    } else {
                         $txtUserPwd.popover('hide');
                         $txtUserName.popover('hide');
                         $txtUserRePwd.popover('hide');
                    }
                    return true;
               })
          });
          </script>
     </body>
</html>